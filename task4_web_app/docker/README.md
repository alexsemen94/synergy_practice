# Docker –¥–ª—è Tourism System

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Tourism System –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

## üê≥ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker

```
docker/
‚îú‚îÄ‚îÄ Dockerfile.delphi      # –û–±—Ä–∞–∑ –¥–ª—è Delphi backend
‚îú‚îÄ‚îÄ Dockerfile.web         # –û–±—Ä–∞–∑ –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ docker-compose.yml     # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ nginx.conf            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ init-db.sh            # –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ start.sh              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Linux/Mac)
‚îú‚îÄ‚îÄ stop.sh               # –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (Linux/Mac)
‚îú‚îÄ‚îÄ start.ps1             # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Windows)
‚îú‚îÄ‚îÄ stop.ps1              # –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (Windows)
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### Windows (PowerShell)
```powershell
# –ó–∞–ø—É—Å–∫
.\docker\start.ps1

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
.\docker\stop.ps1
```

### Linux/Mac (Bash)
```bash
# –ó–∞–ø—É—Å–∫
chmod +x docker/start.sh
./docker/start.sh

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
chmod +x docker/stop.sh
./docker/stop.sh
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up --build -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker

### –°–µ—Ä–≤–∏—Å—ã

1. **db** - MS SQL Server 2019
   - –ü–æ—Ä—Ç: 1433
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: TourismDB
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: sa
   - –ü–∞—Ä–æ–ª—å: YourStrong@Passw0rd

2. **delphi** - Delphi Web Application Backend
   - –ü–æ—Ä—Ç: 8080
   - API endpoints –¥–ª—è —Ç—É—Ä–æ–≤, –∫–ª–∏–µ–Ω—Ç–æ–≤, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MS SQL Server

3. **web** - Nginx –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
   - –ü–æ—Ä—Ç: 80
   - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
   - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Delphi backend

4. **redis** - –ö—ç—à-—Å–µ—Ä–≤–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü–æ—Ä—Ç: 6379
   - –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

5. **adminer** - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
   - –ü–æ—Ä—Ç: 8081
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ MS SQL Server

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `DB_CONNECTION_STRING` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- `ASPNETCORE_URLS` - URL –¥–ª—è Delphi backend
- `ASPNETCORE_ENVIRONMENT` - –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Production/Development)

### –ü–æ—Ä—Ç—ã
- **80** - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **8080** - API Backend
- **1433** - MS SQL Server
- **6379** - Redis
- **8081** - Adminer

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f delphi
docker-compose logs -f web
docker-compose logs -f db

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
docker-compose exec delphi curl -f http://localhost:8080/api/tours
docker-compose exec web curl -f http://localhost/
```

### –ú–µ—Ç—Ä–∏–∫–∏
- Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```bash
# Delphi backend
docker-compose exec delphi bash

# –í–µ–±-—Å–µ—Ä–≤–µ—Ä
docker-compose exec web sh

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
docker-compose exec db bash
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose build delphi
docker-compose up -d delphi

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up --build -d
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ Nginx
- Access logs: `/var/log/nginx/access.log`
- Error logs: `/var/log/nginx/error.log`

### –õ–æ–≥–∏ Delphi
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –≤ Docker logs
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ MS SQL Server
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –ª–æ–≥–∏

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
   netstat -an | findstr :80
   netstat -an | findstr :8080
   ```

2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ë–î
   docker-compose logs db
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
   docker-compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P YourStrong@Passw0rd -Q "SELECT 1"
   ```

3. **Delphi backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
   docker-compose logs delphi
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
   docker-compose exec delphi env | grep DB_CONNECTION_STRING
   ```

### –û—á–∏—Å—Ç–∫–∞
```bash
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
docker-compose down --volumes --remove-orphans
docker system prune -f
docker volume prune -f
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±—Ä–∞–∑–æ–≤
docker images

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–º–æ–≤
docker volume ls

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Ç–µ–π
docker network ls

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
docker system prune -a
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤
docker-compose pull

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –Ω–æ–≤—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏
docker-compose up -d
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
docker-compose up --build -d
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏ Docker –∏ Docker Compose
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
